<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Bar Mitzvah Attack · xd_xd's blog</title><meta name="description" content="Bar Mitzvah Attack - xd_xd"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.ico"><link rel="stylesheet" href="/css/apollo.css"><script src="/js/jquery-3.1.0.min.js"></script><script src="/js/jquery.goup.js"></script><script src="/js/goup.js"></script><link rel="search" type="application/opensearchdescription+xml" href="http://xdxd.love/atom.xml" title="xd_xd's blog"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/logo.jpg"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="https://github.com/hkalexling" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/archives" target="_self" class="nav-list-link">ARCHIVES</a></li><li class="nav-list-item"><a href="/friends" target="_self" class="nav-list-link">FRIENDS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Bar Mitzvah Attack</h1><div class="post-info">Mar 30, 2015</div><div class="post-content"><p>漏洞危害：RC4 算法存在缺陷，它能够在某些情况下泄露SSL/TLS加密流量中的密文，从而将账户用户名密码，信用卡数据和其他敏感信息泄露给黑客。</p>
<p>漏洞评级： 高</p>
<p>修复建议：禁用RC4算法 2015-1-5 开始 github 已经停止支持RC4 算法了。禁用RC4会导致IE6无法访问</p>
<p>检测方式：linux shell下执行： openssl s_client -connect ys7.com:443 -cipher RC4</p>
<pre><code><span class="attr_selector">[root@localhost ~]</span># <span class="tag">openssl</span> <span class="tag">s_client</span> <span class="tag">-connect</span> <span class="tag">ys7</span><span class="class">.com</span><span class="pseudo">:443</span> <span class="tag">-cipher</span> <span class="tag">RC4</span>
<span class="tag">CONNECTED</span>(<span class="number">00000003</span>)
<span class="tag">140184490301256</span><span class="pseudo">:error</span><span class="pseudo">:14077410</span><span class="pseudo">:SSL</span> <span class="tag">routines</span><span class="pseudo">:SSL23_GET_SERVER_HELLO</span><span class="pseudo">:sslv3</span> <span class="tag">alert</span> <span class="tag">handshake</span> <span class="tag">failure</span><span class="pseudo">:s23_clnt</span><span class="class">.c</span><span class="pseudo">:741</span>:
<span class="tag">---</span>
<span class="tag">no</span> <span class="tag">peer</span> <span class="tag">certificate</span> <span class="tag">available</span>
<span class="tag">---</span>
<span class="tag">No</span> <span class="tag">client</span> <span class="tag">certificate</span> <span class="tag">CA</span> <span class="tag">names</span> <span class="tag">sent</span>
<span class="tag">---</span>
<span class="tag">SSL</span> <span class="tag">handshake</span> <span class="tag">has</span> <span class="tag">read</span> <span class="tag">7</span> <span class="tag">bytes</span> <span class="tag">and</span> <span class="tag">written</span> <span class="tag">82</span> <span class="tag">bytes</span>
<span class="tag">---</span>
<span class="tag">New</span>, (NONE), <span class="tag">Cipher</span> <span class="tag">is</span> (NONE)
<span class="tag">Secure</span> <span class="tag">Renegotiation</span> <span class="tag">IS</span> <span class="tag">NOT</span> <span class="tag">supported</span>
<span class="tag">Compression</span>: <span class="tag">NONE</span>
<span class="tag">Expansion</span>: <span class="tag">NONE</span>
<span class="tag">---</span>
</code></pre><p>返回alert handshake failure: 说明不支持rc4算法。<br>返回证书相关信息说明支持RC4.如下：</p>
<pre><code>[root@localhost ~]# openssl s_client -connect adobe.com:443 -cipher RC4
CONNECTED(00000003)
depth=3 C = <span class="keyword">US</span>, O = <span class="string">"VeriSign, Inc."</span>, <span class="keyword">OU</span> = <span class="keyword">Class</span> 3 Public Primary Certification Authority
verify <span class="keyword">return</span>:1
depth=2 C = <span class="keyword">US</span>, O = <span class="string">"VeriSign, Inc."</span>, <span class="keyword">OU</span> = VeriSign Trust Network, <span class="keyword">OU</span> = <span class="string">"(c) 2006 VeriSign, Inc. - For authorized use only"</span>, CN = VeriSign <span class="keyword">Class</span> 3 Public Primary Certification Authority - G5
verify <span class="keyword">return</span>:1
depth=1 C = <span class="keyword">US</span>, O = <span class="string">"VeriSign, Inc."</span>, <span class="keyword">OU</span> = VeriSign Trust Network, <span class="keyword">OU</span> = Terms of <span class="keyword">use</span> at https:<span class="comment">//www.verisign.com/rpa (c)10, CN = VeriSign Class 3 International Server CA - G3</span>
verify <span class="keyword">return</span>:1
depth=0 C = <span class="keyword">US</span>, <span class="keyword">ST</span> = California, <span class="keyword">L</span> = San Jose, O = Adobe Systems Incorporated, <span class="keyword">OU</span> = IT Load Balancer Service, CN = www.adobe.com
verify <span class="keyword">return</span>:1
---
Certificate chain
0 s:/C=<span class="keyword">US</span>/<span class="keyword">ST</span>=California/<span class="keyword">L</span>=San Jose/O=Adobe Systems Incorporated/<span class="keyword">OU</span>=IT Load Balancer Service/CN=www.adobe.com
i:/C=<span class="keyword">US</span>/O=VeriSign, Inc./<span class="keyword">OU</span>=VeriSign Trust Network/<span class="keyword">OU</span>=Terms of <span class="keyword">use</span> at https:<span class="comment">//www.verisign.com/rpa (c)10/CN=VeriSign Class 3 International Server CA - G3</span>
1 s:/C=<span class="keyword">US</span>/O=VeriSign, Inc./<span class="keyword">OU</span>=VeriSign Trust Network/<span class="keyword">OU</span>=Terms of <span class="keyword">use</span> at https:<span class="comment">//www.verisign.com/rpa (c)10/CN=VeriSign Class 3 International Server CA - G3</span>
i:/C=<span class="keyword">US</span>/O=VeriSign, Inc./<span class="keyword">OU</span>=VeriSign Trust Network/<span class="keyword">OU</span>=(c) 2006 VeriSign, Inc. - <span class="keyword">For</span> authorized <span class="keyword">use</span> only/CN=VeriSign <span class="keyword">Class</span> 3 Public Primary Certification Authority - G5
2 s:/C=<span class="keyword">US</span>/O=VeriSign, Inc./<span class="keyword">OU</span>=VeriSign Trust Network/<span class="keyword">OU</span>=(c) 2006 VeriSign, Inc. - <span class="keyword">For</span> authorized <span class="keyword">use</span> only/CN=VeriSign <span class="keyword">Class</span> 3 Public Primary Certification Authority - G5
i:/C=<span class="keyword">US</span>/O=VeriSign, Inc./<span class="keyword">OU</span>=<span class="keyword">Class</span> 3 Public Primary Certification Authority
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIFWzCCBEOgAwIBAgIQUpTiPwuMEg3M1gB/pbuYwDANBgkqhkiG9w0BAQUFADCB
vDELMAkGA1UEBhMCVVMxFzAVBgNVBAoTDlZlcmlTaWduLCBJbmMuMR8wHQYDVQQL
ExZWZXJpU2lnbiBUcnVzdCBOZXR3b3JrMTswOQYDVQQLEzJUZXJtcyBvZiB1c2Ug
YXQgaHR0cHM6Ly93d3cudmVyaXNpZ24uY29tL3JwYSAoYykxMDE2MDQGA1UEAxMt
</code></pre><p>参考资料：<br><a href="http://www.freebuf.com/news/62301.html" target="_blank" rel="external">http://www.freebuf.com/news/62301.html</a><br><a href="https://sobug.com/article/detail/17" target="_blank" rel="external">https://sobug.com/article/detail/17</a></p>
</div></article></div></section><footer><div class="paginator"><a href="/2015/03/30/安全体系建设/" class="prev">上一篇</a><a href="/2015/03/25/maccms/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2016 <a href="http://xdxd.love">xd_xd</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/hkalexling/Yuno-Apollo" target="_blank">Yuno-Apollo</a>.</p></div></footer></div><script src="https://cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>